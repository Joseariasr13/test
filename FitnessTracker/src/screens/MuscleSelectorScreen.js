import React, { useState } from 'react';
import { View, StyleSheet, Image, Text, Dimensions, SafeAreaView, TouchableOpacity } from 'react-native';
import Svg, { Path } from 'react-native-svg';


const { width, height } = Dimensions.get('window');

const MuscleSelectorScreen = ({ navigation }) => {
  const [showFront, setShowFront] = useState(true);
  const [selectedMuscle, setSelectedMuscle] = useState(null);
  
  const FrontMusclePaths = {
    chest: "m 112.69276,120.08021 c 0,0 10.08732,-21.98513 24.97348,-24.19793 10.88615,-2.21281 20.15135,10.48965 20.15135,10.48965 l 7.25356,0.60349 c 0,0 15.92109,-19.77232 30.41656,-9.45472 12.49547,20.31759 15.71992,29.77231 15.71992,29.77231 0,0 -15.92108,10.89198 -22.76067,10.28849 -6.83959,-0.60349 -13.67917,1.20699 -24.57115,-4.42561 -10.89198,-5.6326 -1.20699,-0.40233 -1.20699,-0.40233 l -7.05239,0.40233 c 0,0 -8.86287,4.23609 -20.94437,3.0291 -10.0815,-1.20698 -27.38745,-10.28848 -27.38745,-10.28848",
    shoulders: "m 92.717778,128.8744 c 0,0 -8.215888,-51.130897 43.492562,-36.66482 0,0 -17.88853,9.92283 -23.8628,28.69912 M 232.282222,130.8744 c -5,0 1.215888,-61.130897 -43.492562,-36.66482 -6,0 10.88853,9.92283 23.8628,28.69912",
    biceps: "m 116.22853,128.99884 -1.36554,16.38657 c 0,0 -3.86804,20.97765 -9.7461,22.10492 -5.87806,1.12938 -17.04715,7.05534 -17.04715,7.05534 l -2.73109,-20.80588 c 0,0 5.46219,-21.96616 10.18412,-23.11547 4.72193,-1.12938 14.16578,-7.73813 14.16578,-7.73813 l 95.92883,5.87805 c 0,0 5.6898,-8.19328 17.04715,0 11.35734,8.19328 13.18432,24.90687 13.18432,24.90687 l -1.36555,21.07225 -19.64639,-7.93728 c 0,0 -7.49545,-14.53494 -7.73814,-21.32935 -0.24268,-7.05534 -2.27592,-16.38657 -2.27592,-16.38657 l -95.92883,-5.87805 m 425,1 1.36554,16.38657 c 0,0 3.86804,20.97765 9.7461,22.10492 5.87806,1.12938 17.04715,7.05534 17.04715,7.05534 l 2.73109,-20.80588 c 0,0 -5.46219,-21.96616 -10.18412,-23.11547 -4.72193,-1.12938 -14.16578,-7.73813 -14.16578,-7.73813 l -95.92883,5.87805 c 0,0 -5.6898,-8.19328 -17.04715,0 -11.35734,8.19328 -13.18432,24.90687 -13.18432,24.90687 l 1.36555,21.07225 19.64639,-7.93728 c 0,0 7.49545,-14.53494 7.73814,-21.32935 0.24268,-7.05534 2.27592,-16.38657 2.27592,-16.38657 l 95.92883,-5.87805",
    abs: "m 119.33118,130.13842 c 0,0 12.48244,5.26637 19.02569,4.98188 2.54325,-0.28449 25.30239,-0.26734 25.30239,-0.26734 l 2.40959,-0.28449 c 0,0 1.69836,-0.42673 3.54754,0.99571 1.84918,1.42245 7.8063,2.13367 7.8063,2.13367 l 6.24162,1.70694 c 0,0 7.23732,-2.27592 13.92282,-6.6855 2.6855,-4.40958 3.39672,-2.41816 3.39672,-2.41816 l 0.41816,15.62976 c 0,0 -6.95283,2.96999 -6.24161,22.88424 0.71122,15.91425 1.12938,21.88852 1.12938,21.88852 0,0 -0.29306,16.34098 -1.43102,18.90139 -1.13796,2.5604 -0.28449,3.8406 -0.84489,6.96999 -2.56041,3.12938 -1.55612,2.84489 -1.55612,2.84489 l -15.20303,14.06507 -9.51324,13.35384 -3.68978,6.11652 h -10.6512 l -6.5261,-10.36671 c 0,0 -15.62976,-21.03505 -18.33241,-20.32383 -2.70265,0.71122 -7.37957,-11.37957 -7.37957,-11.37957 0,0 0.70265,-40.52257 1.98285,-42.79849 1.2802,-2.27591 -0.70265,-16.90996 -0.70265,-16.90996 l -4.25876,-6.5261 c 0,0 0.7471,-16.23967 1.14732,-14.51227 m 4,0 c 0,0 12.48244,5.26637 19.02569,4.98188 2.54325,-0.28449 25.30239,-0.26734 25.30239,-0.26734 l 2.40959,-0.28449 c 0,0 1.69836,-0.42673 3.54754,0.99571 1.84918,1.42245 7.8063,2.13367 7.8063,2.13367 l 6.24162,1.70694 c 0,0 7.23732,-2.27592 13.92282,-6.6855 2.6855,-4.40958 3.39672,-2.41816 3.39672,-2.41816 l 0.41816,15.62976 c 0,0 -6.95283,2.96999 -6.24161,22.88424 0.71122,15.91425 1.12938,21.88852 1.12938,21.88852 0,0 -0.29306,16.34098 -1.43102,18.90139 -1.13796,2.5604 -0.28449,3.8406 -0.84489,6.96999 -2.56041,3.12938 -1.55612,2.84489 -1.55612,2.84489 l -15.20303,14.06507 -9.51324,13.35384 -3.68978,6.11652 h -10.6512 l -6.5261,-10.36671 c 0,0 -15.62976,-21.03505 -18.33241,-20.32383 -2.70265,0.71122 -7.37957,-11.37957 -7.37957,-11.37957 0,0 0.70265,-40.52257 1.98285,-42.79849 1.2802,-2.27591 -0.70265,-16.90996 -0.70265,-16.90996 l -4.25876,-6.5261 c 0,0 0.7471,-16.23967 1.14732,-14.51227",
    quads: "m 154.06024,249.55557 c 0,0 3.31908,48.02025 -10.66835,77.55332 -13.98743,29.53307 -39.35444,-4.03026 -38.88013,-26.78807 0.47431,-22.75782 0.71146,-41.96217 0.71146,-41.96217 0,0 10.90548,-48.25741 12.80201,-47.06165 1.89653,1.18533 31.53103,28.68566 33.90258,36.04314 2.37155,7.35748 15.64483,2.13367 15.64483,2.13367 0,0 32.95345,-43.85893 35.56371,-37.46496 2.61026,6.39397 21.09962,69.23023 12.56487,97.18381 -8.53474,27.95358 -34.36579,26.31526 -39.58632,13.72532 -5.22053,-12.56486 -11.37957,-62.35057 -11.37957,-62.35057 l 1.89653,-11.85331 c 0,0 -4.03025,3.79306 -12.56486,1.42244",
    
  };
  
  const BackMusclePaths = {
    shoulders: "m 113.21734,117.4413 c 0,0 -18.488122,7.1008 -20.663195,11.92934 -2.175073,4.82854 0.271884,-21.30239 0.271884,-21.30239 0,0 0.271884,-24.710777 39.695081,-23.574649 39.4232,1.136127 67.42727,0 67.42727,0 0,0 39.69507,0.568064 39.96696,24.142709 0.27188,23.57465 -0.27189,22.72255 -0.27189,22.72255 0,0 -7.06899,-10.50918 -11.41913,-10.50918 -4.35015,0 -9.51594,-3.40838 -9.51594,-3.40838 0,0 1.08754,-9.08902 -9.78783,-15.62175 -10.87537,-6.532737 -13.59421,-11.645311 -13.59421,-11.645311 l 3.44008,-5.716445 -65.42966,0.319839 3.39855,4.828542 c 0,0 -8.29246,10.083135 -15.08956,13.065465 -6.79711,2.98234 -8.02059,7.81088 -8.02059,7.81088",
    back: "m 124.52645,212.32181 c 0,0 1.60065,-25.18992 0,-29.69216 -1.60066,-4.50988 -7.11405,-41.76462 -7.11405,-41.76462 0,0 -1.60066,-15.4374 -3.66235,-20.73975 -2.06169,-5.30235 2.06169,-15.16689 2.06169,-15.16689 l 13.92345,-7.76799 7.27527,-7.97483 -4.83851,-5.30235 33.39307,-9.00221 32.93462,9.00221 -3.66235,5.49353 9.42677,9.66959 c 0,0 16.56963,3.66235 12.90996,19.57354 -3.66235,15.9039 -3.89085,22.99777 -3.89085,22.99777 l -2.53294,28.55643 c 0,0 -5.49352,17.04744 -4.34445,28.31993 1.14908,11.27237 0.45964,13.92345 0.45964,13.92345 l -14.27577,-2.30255 c 0,0 -15.9039,4.50988 -20.48667,9.66959 -4.58277,5.15971 -6.87416,10.80852 -6.87416,10.80852 0,0 -1.37483,-11.27237 -13.28788,-16.10802 -11.91305,-4.83565 -16.33833,-3.89085 -16.33833,-3.89085",
    triceps: "m 112.83829,118.88168 c 0,0 5.33972,16.74899 2.66986,25.68182 -2.66986,8.93284 -6.22963,19.8755 -6.22963,19.8755 l -9.158,11.83595 c 0,0 -21.0056,3.12648 -19.19873,-10.04939 1.80687,-13.17582 12.49228,-38.18773 12.49228,-38.18773 0,0 9.158,-8.48616 23.76119,-11.56483 9.60319,-3.07866 102.69868,0.22332 102.69868,0.22332 0,0 20.32303,1.78687 27.89497,33.72383 7.57194,31.93696 -4.6899,27.24325 -14.52099,24.55114 -9.83109,-2.69212 -17.64396,-34.168 -17.64396,-34.168 l 3.79185,-23.67193 c 0,0 -113.90232,-6.25303 -102.07629,1.78687",
    glutes: "m 118.93955,248.09964 c 0,0 -7.77095,24.17469 11.14308,28.33858 18.91403,4.16388 31.32472,0.9253 31.32472,0.9253 l 0.66711,-7.5715 3.24567,-7.34783 4.40699,8.91035 0.46389,6.26244 c 0,0 28.53346,6.6944 39.26495,-5.77238 10.73148,-12.46678 2.07492,-26.96979 2.07492,-26.96979 0,0 -3.92648,-5.9967 -4.63893,-9.73345 -0.71245,-3.73675 -1.16306,-6.94177 -1.16306,-6.94177 l -16.22672,-16.89493 c 0,0 -16.46387,5.78714 -18.79501,10.89875 -2.33114,5.11161 -4.86635,7.88754 -4.86635,7.88754 l -6.70163,-9.96461 c 0,0 -14.14815,-10.89875 -17.64283,-8.02193 -3.49467,2.87682 -15.75875,16.46387 -15.75875,16.46387 0,0 -0.23195,7.66316 -6.9584,20.33947",
    hamstrings: "m 166.96193,264.09368 -3.78979,8.91717 c 0,0 -0.44593,27.20186 -3.57881,32.10602 -3.13288,4.90414 -8.47009,23.85722 -8.47009,23.85722 0,0 -5.79708,30.312 -7.58959,31.20126 -1.79251,0.89122 -7.36015,15.15918 -7.36015,15.15918 l -9.58621,-18.0579 -1.11473,6.01919 -6.24273,-13.82159 -7.11684,4.01351 3.99961,-16.93922 c 0,0 -3.34459,-35.21947 -3.34459,-39.23295 0,-4.01351 0.89122,-19.62183 0.89122,-19.62183 0,0 1.33683,-19.17855 2.88334,-21.18527 1.54651,-2.00671 4.23573,-5.34562 4.23573,-5.34562 0,0 -1.33683,19.62183 5.34562,23.58355 6.68245,3.96172 10.901,5.12736 10.901,5.12736 0,0 16.49848,2.22975 20.06752,0.89122 3.56904,-1.3385 6.24273,-3.13288 6.24273,-3.13288 l 3.69959,-14.49462 4.39303,9.0831 0.15771,23.9704 11.98282,33.1564 c 0,0 5.62329,30.11033 8.992,34.82597 3.3687,4.71564 6.14951,10.88516 6.14951,10.88516 0,0 5.98604,-15.45284 6.94868,-15.60515 0.96264,-0.15231 2.20682,-1.57238 2.20682,-1.57238 l 1.26119,6.46224 c 0,0 4.09863,-15.45284 6.31747,-14.50616 2.21884,0.94468 7.56905,4.09863 7.56905,4.09863 l -4.25331,-14.65296 c 0,0 0.94831,-26.4902 -0.94831,-27.79291 0,-1.30072 0.78927,-45.55682 0.78927,-45.55682 0,0 -2.36325,-9.14416 -5.04528,-11.98282 -2.68203,-2.83866 -2.36325,-1.26119 -2.36325,-1.26119 0,0 2.04932,24.5915 -12.7534,26.1708 -14.79965,-1.57854 -17.64666,2.04932 -17.64666,2.04932 0,0 -10.40481,-1.41933 -10.72212,-2.67826 -0.31731,-1.25893 -0.47935,-5.83293 -0.47935,-5.83293 l -4.42855,-9.09234",
    calves: "m 134.52605,376.47392 c 0,0 -9.82873,-21.28913 -10.4069,-18.87904 -0.57816,2.41009 -1.54176,8.63616 -1.54176,8.63616 0,0 -5.78161,-18.47736 -6.93793,-17.47316 -1.15633,1.00421 -7.90154,4.82018 -7.90154,4.82018 0,0 -0.19272,13.2555 0.19271,15.06307 0.38545,1.80757 -7.708805,13.2555 -10.792337,34.14295 -3.083523,20.88745 -1.349037,22.69502 -1.349037,22.69502 0,0 8.672414,-3.81598 10.792334,-8.43532 2.11992,-4.61934 3.27625,-5.4227 3.27625,-5.4227 0,0 7.90154,13.65718 11.56322,15.2639 3.66169,1.60673 4.81801,2.61093 4.81801,2.61093 0,0 4.81802,-13.25549 4.04713,-21.89165 -0.77087,-8.63616 3.85934,-31.99806 4.1319,-31.99806 0.27255,0 64.45756,0.21303 64.45756,0.21303 0,0 8.04015,-21.44441 9.13035,-17.752 1.09019,3.69242 1.63528,8.09491 1.63528,8.09491 0,0 4.36077,-20.02425 6.8137,-17.18393 2.45293,2.84032 7.08624,4.4025 7.08624,4.4025 l 0.40882,14.48562 c 0,0 6.16533,15.83786 7.89981,19.25216 1.73448,3.41429 2.69809,8.837 2.69809,8.837 l 2.31264,28.92108 c 0,0 -10.4069,-4.82018 -11.3705,-7.63195 -0.96361,-2.81177 -3.66169,-5.22186 -3.66169,-5.22186 0,0 -5.5889,10.04204 -7.32337,11.44793 -1.73449,1.40588 -5.97434,7.83279 -7.70883,5.22186 -1.73448,-2.61093 -6.35977,-11.44793 -6.16705,-16.26811 0.19272,-4.82018 -0.19272,-27.71604 -0.19272,-27.71604 l -1.61403,-8.93742 -64.47244,-0.0938",
};
  const muscleMapping = {
    chest: "pecho",
    back: "espalda",
    shoulders: "hombros",
    biceps: "bíceps",
    triceps: "tríceps",
    abs: "abdominales",
    quads: "cuádriceps",
    calves: "gemelos",
    glutes: "glúteos",
    hamstrings: "isquiotibiales"
  };

  const handleMusclePress = (muscle) => {
    setSelectedMuscle(muscle === selectedMuscle ? null : muscle);
    
    if (muscle && muscleMapping[muscle]) {
      navigation.navigate('Exercises', { 
        muscle: muscleMapping[muscle]
      });
    }
  };

  return (
    <SafeAreaView style={styles.container}>
      <Text style={styles.title}>Guía Muscular</Text>
      
      <View style={styles.imageContainer}>
        <Image 
          source={showFront 
            ? require('../../src/assets/muscle-map-front.png')
            : require('../../src/assets/muscle-map-back.png')
          }
          style={styles.image}
          resizeMode="contain"
        />
        
        <Svg style={StyleSheet.absoluteFill}>
          {showFront ? (
            // Músculos frontales
            Object.entries(FrontMusclePaths).map(([muscle, path]) => (
              <Path
                key={muscle}
                d={path}
                fill={selectedMuscle === muscle ? "rgba(255, 0, 0, 0.3)" : "transparent"}
                stroke="transparent"
                onPress={() => handleMusclePress(muscle)}
              />
            ))
          ) : (
            // Músculos posteriores
            Object.entries(BackMusclePaths).map(([muscle, path]) => (
              <Path
                key={muscle}
                d={path}
                fill={selectedMuscle === muscle ? "rgba(255, 0, 0, 0.3)" : "transparent"}
                stroke="transparent"
                onPress={() => handleMusclePress(muscle)}
              />
            ))
          )}
        </Svg>
      </View>

      <TouchableOpacity 
        style={styles.toggleButton} 
        onPress={() => {
          setShowFront(!showFront);
          setSelectedMuscle(null);
        }}
      >
        <Text style={styles.toggleButtonText}>
          {showFront ? 'Ver Vista Posterior' : 'Ver Vista Frontal'}
        </Text>
      </TouchableOpacity>
    </SafeAreaView>
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#ffffff',
    alignItems: 'center',
    paddingTop: 20,
  },
  title: {
    fontSize: 24,
    fontWeight: 'bold',
    marginBottom: 20,
    color: '#2196F3',
  },
  imageContainer: {
    width: width * 0.9,
    height: height * 0.7,
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: '#f9f9f9',
    borderRadius: 10,
    overflow: 'hidden',
    marginVertical: 20,
  },
  image: {
    width: '100%',
    height: '100%',
  },
  toggleButton: {
    backgroundColor: '#2196F3',
    paddingVertical: 12,
    paddingHorizontal: 24,
    borderRadius: 25,
    elevation: 3,
    shadowColor: '#000',
    shadowOffset: {
      width: 0,
      height: 2,
    },
    shadowOpacity: 0.25,
    shadowRadius: 3.84,
  },
  toggleButtonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: 'bold',
  },
});

export default MuscleSelectorScreen;